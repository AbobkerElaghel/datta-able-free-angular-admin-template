"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[276],{2356:(j,v,t)=>{t.d(v,{n:()=>U});var g=t(4412),i=t(6496),f=t(8141),c=t(3471),p=t(1025),$=t(3953),r=t(3197),e=t(5842),E=t(8655);let U=(()=>{class F{constructor(l,m,u){this.sharedFacade=l,this.EmployeesServices=m,this.employeeGlobalServices=u,this.employeeSubject$=new g.t([]),this.employee$=this.employeeSubject$.asObservable(),this.employeePageSubject$=new g.t([]),this.employeePage$=this.employeePageSubject$.asObservable()}deleteEmployee(l){const m=this.EmployeesServices.DeleteEmployee(l).pipe((0,f.M)(u=>{if(u.type==c.yl.Success){this.sharedFacade.showMessage(c.Go.success," \u062d\u0630\u0641 \u0645\u0633\u062a\u062e\u062f\u0645",["\u062a\u0645 \u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d"]);const O=this.employeeSubject$.getValue().filter(C=>C.id!=l);this.employeeSubject$.next(O),this.employeeSubject$.subscribe()}else this.sharedFacade.showMessage(c.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062d\u0630\u0641",u.messages)}),(0,i.t)());this.sharedFacade.showLoaderUntilCompleted(m).pipe().subscribe()}GetEmployee(l){const m=this.employeeGlobalServices.GetEmployeeSmallObject(l).pipe((0,f.M)(u=>{u.type==c.yl.Success?this.employeeSubject$.next(u.content):(this.employeeSubject$.next([]),this.sharedFacade.showMessage(c.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062c\u0644\u0628 \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646",u.messages))}),(0,i.t)());this.sharedFacade.showLoaderUntilCompleted(m).pipe().subscribe()}GetEmployeePage(l,m){const u=this.employeeGlobalServices.GetEmployee(l,m).pipe((0,f.M)(M=>{M.type==c.yl.Success?this.employeePageSubject$.next(M.content):(this.employeePageSubject$.next([]),this.sharedFacade.showMessage(c.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062c\u0644\u0628 \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646",M.messages))}),(0,i.t)());this.sharedFacade.showLoaderUntilCompleted(u).pipe().subscribe()}UpdateEmployee(l){const m=this.EmployeesServices.UpdateEmployee(l).pipe((0,f.M)(u=>{if(u.type==c.yl.Success){this.sharedFacade.showMessage(c.Go.success,"\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u0646\u062c\u0627\u062d",u.messages);const M=this.employeeSubject$.getValue();this.employeeSubject$.next((0,p.jM)(M,O=>{const C=O.findIndex(P=>P.id===l.id);O[C]=l})),this.employeeSubject$.subscribe()}else this.sharedFacade.showMessage(c.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u062a\u0639\u062f\u064a\u0644",u.messages)}),(0,i.t)());this.sharedFacade.showLoaderUntilCompleted(m).pipe().subscribe()}static#e=this.\u0275fac=function(m){return new(m||F)($.KVO(r.I),$.KVO(e.v),$.KVO(E.U))};static#t=this.\u0275prov=$.jDH({token:F,factory:F.\u0275fac})}return F})()},5842:(j,v,t)=>{t.d(v,{v:()=>c});var g=t(3953),i=t(1626),f=t(1441);let c=(()=>{class p{constructor(r,e){this.http=r,this.appConfig=e,this.url=this.appConfig.defaultUrl}UpdateEmployee(r){return this.http.put(`${this.url}/api/Employee/UpdateEmployee?culture=ar-LY`,r)}DeleteEmployee(r){return this.http.delete(`${this.url}/api/Employee/DeleteEmployee?Id=${r}&culture=ar-LY`)}static#e=this.\u0275fac=function(e){return new(e||p)(g.KVO(i.Qq),g.KVO(f.o))};static#t=this.\u0275prov=g.jDH({token:p,factory:p.\u0275fac})}return p})()},276:(j,v,t)=>{t.r(v),t.d(v,{EmployeeEvaluationRolesManageModule:()=>N});var g=t(177),i=t(9417),f=t(1786),c=t(9947),p=t(4823),$=t(9631),r=t(8834),e=t(3953),E=t(1626),U=t(1441);let F=(()=>{class n{constructor(a,s){this.http=a,this.appConfig=s,this.url=this.appConfig.defaultUrl}UpdateOrganizationalUnit(a){return this.http.put(`${this.url}/api/Position/DefineManagersForTheOrganizationalUnit?culture=ar-LY`,a)}GetManagersForOrganizationalUnit(a){return this.http.get(`${this.url}/api/Position/GetManagersForOrganizationalUnitQuery?culture=ar-LY`,{params:{OrganizationalUnitId:a}})}static#e=this.\u0275fac=function(s){return new(s||n)(e.KVO(E.Qq),e.KVO(U.o))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac})}return n})();var S=t(3471),l=t(1413),m=t(8141),u=t(6496),M=t(3197);let O=(()=>{class n{constructor(a,s){this.employeeEvaluationRolesManageServices=a,this.sharedFacade=s,this.employeeSubject$=new l.B}UpdateOrganizationalUnit(a){const s=this.employeeEvaluationRolesManageServices.UpdateOrganizationalUnit(a).pipe((0,m.M)(o=>{o.type==S.yl.Success?this.sharedFacade.showMessage(S.Go.success,"\u062a\u0645\u062a \u0627\u0644\u062a\u062d\u062f\u064a\u062b \u0628\u0646\u062c\u0627\u062d",o.messages):this.sharedFacade.showMessage(S.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062a\u062d\u062f\u064a\u062b",o.messages)}),(0,u.t)());this.sharedFacade.showLoaderUntilCompleted(s).pipe().subscribe()}GetManagersForOrganizationalUnit(a){const s=this.employeeEvaluationRolesManageServices.GetManagersForOrganizationalUnit(a).pipe((0,m.M)(o=>{o.type==S.yl.Success?this.employeeSubject$.next(o.content[0]):(this.employeeSubject$.next(null),this.sharedFacade.showMessage(S.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062c\u0644\u0628 \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646",o.messages))}),(0,u.t)());this.sharedFacade.showLoaderUntilCompleted(s).pipe().subscribe()}static#e=this.\u0275fac=function(s){return new(s||n)(e.KVO(F),e.KVO(M.I))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac})}return n})();var C=t(7062),P=t(6354),D=t(2298),b=t(2356),L=t(2016),T=t(2702),G=t(152),I=t(3294),A=t(5964),B=t(7786),K=t(5558),R=t(3391);const z=["instance"];let H=(()=>{class n{constructor(){this.placeholder="",this.resultFormatter=a=>a,this.inputFormatter=a=>a,this.valueSelected=new e.bkB,this.focus$=new l.B,this.click$=new l.B}ngOnInit(){this.instance._valueChanges$.pipe((0,G.B)(500),(0,I.F)()).subscribe(a=>{a&&"string"==typeof a&&this.focus$.next(a)})}get searchFunction(){return a=>{const s=a.pipe((0,G.B)(500),(0,I.F)()),o=this.click$.pipe((0,A.p)(()=>!this.instance.isPopupOpen()));return(0,B.h)(s,this.focus$,o).pipe((0,K.n)(h=>this.searchHandler(h)))}}onFocus(a){this.focus$.next(a.target.value||"")}onClick(a){this.click$.next(a.target.value||"")}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-typeahead-input"]],viewQuery:function(s,o){if(1&s&&e.GBs(z,7),2&s){let d;e.mGM(d=e.lsd())&&(o.instance=d.first)}},inputs:{placeholder:"placeholder",control:"control",searchHandler:"searchHandler",resultFormatter:"resultFormatter",inputFormatter:"inputFormatter"},outputs:{valueSelected:"valueSelected"},decls:2,vars:5,consts:[["instance","ngbTypeahead"],["type","text","autocomplete","on",1,"form-control",3,"focus","click","placeholder","ngbTypeahead","resultFormatter","inputFormatter","formControl"]],template:function(s,o){if(1&s){const d=e.RV6();e.j41(0,"input",1,0),e.bIt("focus",function(y){return e.eBV(d),e.Njj(o.onFocus(y))})("click",function(y){return e.eBV(d),e.Njj(o.onClick(y))}),e.k0s()}2&s&&e.Y8G("placeholder",o.placeholder)("ngbTypeahead",o.searchFunction)("resultFormatter",o.resultFormatter)("inputFormatter",o.inputFormatter)("formControl",o.control)},dependencies:[i.me,i.BC,i.l_,R.$n],encapsulation:2})}return n})();const V=["instance"],W=[{path:"",component:(()=>{class n{constructor(a,s,o,d){this.organizationalUnitFacade=a,this.employeeFacade=s,this.employeeEvaluationRolesManageFacade=o,this.fb=d,this.compareById=(h,y)=>h&&y?h.id===y.id:h===y,this.employees=this.employeeFacade.employee$,this.organizationalUnitSearchHandler=h=>this.organizationalUnitFacade.OrganizationalUnit$.pipe((0,P.T)(y=>""===h?y:y.filter(J=>J.name.toLowerCase().includes(h.toLowerCase())))),this.searchHandler=h=>(h&&this.employeeFacade.GetEmployee(h),this.employees.pipe((0,P.T)(y=>y))),this.nameFormatter=h=>h.name}ngOnInit(){this.organizationalUnitFacade.GetOrganizationalUnit(),this.form=this.fb.group({organizationalUnit:[null,i.k0.required],directManager:[""],higherLevelManager:[""],departmentManager:[""]}),this.form.get("organizationalUnit").valueChanges.subscribe(a=>{a&&a.id&&this.employeeEvaluationRolesManageFacade.GetManagersForOrganizationalUnit(a.id)}),this.employeeEvaluationRolesManageFacade.employeeSubject$.subscribe(a=>{this.form.patchValue({directManager:a?.directManagerId,higherLevelManager:a?.higherLevelManagerId,departmentManager:a?.departmentManagerId})})}onSubmit(){this.form.value.organizationalUnit&&this.employeeEvaluationRolesManageFacade.UpdateOrganizationalUnit({id:this.form.value.organizationalUnit.id,departmentManagerId:this.form.value.departmentManager?.id,directManagerId:this.form.value.directManager?.id,higherLevelManagerId:this.form.value.higherLevelManager?.id})}static#e=this.\u0275fac=function(s){return new(s||n)(e.rXU(D.$),e.rXU(b.n),e.rXU(O),e.rXU(i.ok))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["employee-evaluation-roles-manage"]],viewQuery:function(s,o){if(1&s&&e.GBs(V,7),2&s){let d;e.mGM(d=e.lsd())&&(o.instance=d.first)}},decls:27,vars:21,consts:[[1,"row"],[1,"card"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-group","col-md-6"],["for","organizationalUnit"],[3,"placeholder","control","searchHandler","resultFormatter","inputFormatter"],[1,"form-group","row"],[1,"form-group","col-md-4"],["for","directManager"],["for","higherLevelManager"],["for","departmentManager"],["type","submit",1,"btn","btn-md","btn-themeAdd","has-ripple"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.nrm(1,"app-loading")(2,"app-messages"),e.j41(3,"div",1)(4,"div",2)(5,"form",3),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",0)(7,"div",4)(8,"div",5)(9,"label",6),e.EFF(10,"\u0627\u0644\u0648\u062d\u062f\u0627\u062a \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629"),e.k0s(),e.nrm(11,"app-typeahead-input",7),e.k0s()()(),e.j41(12,"div",8)(13,"div",9)(14,"label",10),e.EFF(15,"\u0627\u0644\u0645\u062f\u064a\u0631 \u0627\u0644\u0645\u0628\u0627\u0634\u0631"),e.k0s(),e.nrm(16,"app-typeahead-input",7),e.k0s(),e.j41(17,"div",9)(18,"label",11),e.EFF(19,"\u0627\u0644\u0645\u062f\u064a\u0631 \u0627\u0644\u0623\u0639\u0644\u0649"),e.k0s(),e.nrm(20,"app-typeahead-input",7),e.k0s(),e.j41(21,"div",9)(22,"label",12),e.EFF(23,"\u0645\u062f\u064a\u0631 \u0627\u0644\u0625\u062f\u0627\u0631\u0629"),e.k0s(),e.nrm(24,"app-typeahead-input",7),e.k0s()(),e.j41(25,"button",13),e.EFF(26,"\u062d\u0641\u0638"),e.k0s()()()()()),2&s&&(e.R7$(5),e.Y8G("formGroup",o.form),e.R7$(6),e.Y8G("placeholder","\u0627\u0644\u0648\u062d\u062f\u0627\u062a \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629...")("control",o.form.controls.organizationalUnit)("searchHandler",o.organizationalUnitSearchHandler)("resultFormatter",o.nameFormatter)("inputFormatter",o.nameFormatter),e.R7$(5),e.Y8G("placeholder","\u0627\u0644\u0645\u062f\u064a\u0631 \u0627\u0644\u0645\u0628\u0627\u0634\u0631...")("control",o.form.controls.directManager)("searchHandler",o.searchHandler)("resultFormatter",o.nameFormatter)("inputFormatter",o.nameFormatter),e.R7$(4),e.Y8G("placeholder","\u0627\u0644\u0645\u062f\u064a\u0631 \u0627\u0644\u0623\u0639\u0644\u0649...")("control",o.form.controls.higherLevelManager)("searchHandler",o.searchHandler)("resultFormatter",o.nameFormatter)("inputFormatter",o.nameFormatter),e.R7$(4),e.Y8G("placeholder","\u0645\u062f\u064a\u0631 \u0627\u0644\u0625\u062f\u0627\u0631\u0629...")("control",o.form.controls.departmentManager)("searchHandler",o.searchHandler)("resultFormatter",o.nameFormatter)("inputFormatter",o.nameFormatter))},dependencies:[i.qT,i.cb,i.j4,L.q,T.y,H]})}return n})(),data:{breadcrumb:"\u0625\u062f\u0627\u0631\u0629 \u0645\u0633\u0626\u0648\u0644\u064a\u0646 \u0627\u0644\u062c\u0647\u0627\u062a \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629"}}];let Y=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.$C({type:n});static#a=this.\u0275inj=e.G2t({imports:[C.iI.forChild(W),C.iI]})}return n})();var Q=t(8964),X=t(5842);let N=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.$C({type:n});static#a=this.\u0275inj=e.G2t({providers:[F,O,D.$,Q.p,b.n,X.v],imports:[g.MD,Y,i.X1,f.G,c.i,p.uc,$.fS,r.Hl,R.h_]})}return n})()},8655:(j,v,t)=>{t.d(v,{U:()=>c});var g=t(3953),i=t(1626),f=t(1441);let c=(()=>{class p{constructor(r,e){this.http=r,this.appConfig=e,this.url=this.appConfig.defaultUrl}GetEmployee(r,e,E="ar-LY"){const U={culture:E};return r&&(U.SearchType=r),e&&(U.Value=e),this.http.get(`${this.url}/api/Employee/GetAllEmployee`,{params:U})}GetEmployeeSmallObject(r,e="ar-LY"){const E={culture:e};return r&&(E.Name=r),this.http.get(`${this.url}/api/Employee/GetEmployees`,{params:E})}static#e=this.\u0275fac=function(e){return new(e||p)(g.KVO(i.Qq),g.KVO(f.o))};static#t=this.\u0275prov=g.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()}}]);